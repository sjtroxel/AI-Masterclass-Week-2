@if (!isModal()) {
  <a routerLink="/" class="btn-secondary back-link">Back to Dashboard</a>
}

@if (loading()) {
  <p class="text-center text-text-secondary mt-8">Loading meetup...</p>
} @else {
  @if (meetup(); as m) {
    <div class="inner-container detail-card rounded-xl border border-border bg-card shadow-glow">
      <!-- Header -->
      <div class="flex items-start justify-between gap-3 mb-4">
        <h1 class="text-2xl font-bold tracking-tight text-text-primary m-0">{{ m.title }}</h1>
        <span class="shrink-0 inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold
                     bg-accent/15 text-accent border border-accent/30">
          @switch (m.activity) {
            @case ('run') { ğŸƒ }
            @case ('bicycle') { ğŸš² }
            @default { ğŸ“ }
          }
          {{ m.activity }}
        </span>
      </div>

      <!-- Info Dashboard Grid -->
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4">
        <div class="rounded-lg bg-background border border-border p-4 flex flex-col gap-1">
          <span class="text-[0.7rem] font-bold uppercase tracking-wider text-text-secondary/70">ğŸ“… Start</span>
          <span class="text-sm font-semibold text-text-primary">{{ m.start_date_time | date:'medium' }}</span>
        </div>
        <div class="rounded-lg bg-background border border-border p-4 flex flex-col gap-1">
          <span class="text-[0.7rem] font-bold uppercase tracking-wider text-text-secondary/70">ğŸ End</span>
          <span class="text-sm font-semibold text-text-primary">{{ m.end_date_time | date:'medium' }}</span>
        </div>
        <div class="rounded-lg bg-background border border-border p-4 flex flex-col gap-1">
          <span class="text-[0.7rem] font-bold uppercase tracking-wider text-text-secondary/70">ğŸ‘¥ Capacity</span>
          <span class="text-sm font-semibold text-text-primary">{{ m.meetup_participants?.length ?? 0 }} / {{ m.guests }} guests</span>
        </div>
        <div class="rounded-lg bg-background border border-border p-4 flex flex-col gap-1">
          <span class="text-[0.7rem] font-bold uppercase tracking-wider text-text-secondary/70">ğŸ¯ Organizer</span>
          <span class="text-sm font-semibold text-text-primary">{{ m.user?.first_name }} {{ m.user?.last_name }}</span>
        </div>
      </div>

      @if (m.location) {
        <div class="rounded-lg bg-background border border-border p-3 mb-4 flex flex-col gap-1">
          <span class="text-[0.7rem] font-bold uppercase tracking-wider text-text-secondary/70">ğŸ“ Location</span>
          <span class="text-sm font-semibold text-text-primary">{{ m.location.address }}, {{ m.location.city }}, {{ m.location.state }} {{ m.location.zip_code }}</span>
        </div>
      }
    </div>

    <section class="comment-section">
      <app-comment-list [comments]="commentService.comments()" />
      <div #commentBottom></div>
      <app-comment-form [meetupId]="meetupId" />
    </section>
  } @else {
    <p class="text-center text-text-secondary mt-8">Meetup not found.</p>
  }
}
